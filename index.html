<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>AI Document Formatter Pro - Next-Gen Formatting Tool By Hamid Noorani</title>
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>pdfjsLib.GlobalWorkerOptions.workerSrc='https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html-docx-js/0.4.0/html-docx.min.js"></script>
    
    <link href="style.css" rel="stylesheet"/>
</head>
<body>
    <div class="container">
        <div class="app-header">
            <h1><i class="fas fa-robot"></i> AI Document Formatter Pro</h1>
            <p>Next-Generation AI-powered document formatting | Upload any file type</p>
            <div class="ai-badge">
                <i class="fas fa-sparkles"></i> Powered by Advanced AI
            </div>
        </div>

        <div class="main-content">
            <div class="tabs">
                <button class="tab active" data-tab="editor">
                    <i class="fas fa-edit"></i> Editor
                </button>
                <button class="tab" data-tab="templates">
                    <i class="fas fa-layer-group"></i> Templates
                </button>
                <button class="tab" data-tab="customize">
                    <i class="fas fa-palette"></i> Customize
                </button>
                <button class="tab" data-tab="preview">
                    <i class="fas fa-eye"></i> Preview
                </button>
            </div>
            

            <div class="tab-content active" data-content="editor">
                <div class="input-section">
                    <div class="input-controls">
                        <button class="btn btn-success" id="uploadBtn">
                            <i class="fas fa-upload"></i> Upload Any File
                        </button>
                        <input accept="*/*" id="fileInput" style="display: none;" type="file"/>
                        
                        <button class="btn btn-primary" id="aiFormatBtn">
                            <i class="fas fa-magic"></i> AI Auto-Format
                        </button>
                        
                        <button class="btn btn-secondary" id="saveTemplateBtn">
                            <i class="fas fa-save"></i> Save as Template
                        </button>
                        
                        <button class="btn btn-danger" id="clearBtn">
                            <i class="fas fa-trash"></i> Clear
                        </button>
                    </div>

                    <div id="aiStatus" class="ai-status" style="display: none;">
                        <div class="ai-status-content">
                            <div class="ai-loader"></div>
                            <div class="ai-status-text">
                                <h4>ðŸ¤– AI Processing</h4>
                                <p id="aiStatusMessage">Analyzing document...</p>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="progressFill"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="fileInfo" class="file-info" style="display: none;">
                        <i class="fas fa-file"></i>
                        <span id="fileName"></span>
                        <span id="fileSize"></span>
                        <span id="fileType" class="file-type-badge"></span>
                    </div>

                    <div id="extractedImagesContainer" class="extracted-images-container" style="display: none;">
                        </div>

                    <textarea id="textInput" placeholder="Paste your document here or upload a file...

ðŸ¤– AI Features:
âœ“ 100% Structure Preservation for Invoices & Excel
âœ“ Smart formatting for reports, resumes, letters
âœ“ Logo, QR code, and image preservation
âœ“ No currency conversion - Original data maintained
âœ“ Enhanced table formatting with borders
âœ“ Multi-language support

Supported formats:
ðŸ“„ DOCX, PDF, TXT
ðŸ“Š XLSX, XLS, CSV (with proper table structure)
ðŸ–¼ï¸ JPG, PNG (with OCR)
ðŸ“‹ HTML, RTF, and more"></textarea>
                </div>
            </div>

            <div class="tab-content" data-content="templates">
                <h2 style="margin-bottom: 20px;">AI-Powered Template Library</h2>
                <p style="color: #666; margin-bottom: 30px;">Select a template and AI will enhance your document styling</p>
                <div class="template-grid" id="templateGrid"></div>
            </div>

            <div class="tab-content" data-content="customize">
                <h2 style="margin-bottom: 20px;">Advanced Document Styling</h2>
                <div class="customization-grid">
                    <div class="custom-card">
                        <h4><i class="fas fa-heading"></i> Header Styling</h4>
                        <div class="control-group">
                            <label>Background Color:</label>
                            <input id="headerBgColor" type="color" value="#ffffff"/>
                        </div>
                        <div class="control-group">
                            <label>Text Color:</label>
                            <input id="headerTextColor" type="color" value="#1a1a1a"/>
                        </div>
                        <div class="control-group">
                            <label>Font Family:</label>
                            <select id="headerFont">
                                <option value="Georgia">Georgia</option>
                                <option value="Arial">Arial</option>
                                <option value="Times New Roman">Times New Roman</option>
                                <option value="Helvetica">Helvetica</option>
                                <option value="Verdana">Verdana</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>Font Size: <span id="headerFontSizeValue">28</span>px</label>
                            <input id="headerFontSize" type="range" min="16" max="48" value="28"/>
                        </div>
                        <div class="control-group">
                            <label>Padding: <span id="headerPaddingValue">20</span>px</label>
                            <input id="headerPadding" type="range" min="0" max="50" value="20"/>
                        </div>
                        <div class="control-group">
                            <label>Text Align:</label>
                            <div class="align-buttons">
                                <button class="align-btn active" data-align="left" data-section="header"><i class="fas fa-align-left"></i></button>
                                <button class="align-btn" data-align="center" data-section="header"><i class="fas fa-align-center"></i></button>
                                <button class="align-btn" data-align="right" data-section="header"><i class="fas fa-align-right"></i></button>
                            </div>
                        </div>
                    </div>

                    <div class="custom-card">
                        <h4><i class="fas fa-file-alt"></i> Body Styling</h4>
                        <div class="control-group">
                            <label>Background Color:</label>
                            <input id="bodyBgColor" type="color" value="#ffffff"/>
                        </div>
                        <div class="control-group">
                            <label>Text Color:</label>
                            <input id="bodyTextColor" type="color" value="#333333"/>
                        </div>
                        <div class="control-group">
                            <label>Font Family:</label>
                            <select id="bodyFont">
                                <option value="Arial" selected>Arial</option>
                                <option value="Georgia">Georgia</option>
                                <option value="Times New Roman">Times New Roman</option>
                                <option value="Helvetica">Helvetica</option>
                                <option value="Verdana">Verdana</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>Font Size: <span id="bodyFontSizeValue">16</span>px</label>
                            <input id="bodyFontSize" type="range" min="12" max="24" value="16"/>
                        </div>
                        <div class="control-group">
                            <label>Line Height: <span id="bodyLineHeightValue">1.8</span></label>
                            <input id="bodyLineHeight" type="range" min="1.0" max="3.0" step="0.1" value="1.8"/>
                        </div>
                        <div class="control-group">
                            <label>Margin: <span id="bodyMarginValue">20</span>px</label>
                            <input id="bodyMargin" type="range" min="0" max="50" value="20"/>
                        </div>
                        <div class="control-group">
                            <label>Text Align:</label>
                            <div class="align-buttons">
                                <button class="align-btn active" data-align="left" data-section="body"><i class="fas fa-align-left"></i></button>
                                <button class="align-btn" data-align="center" data-section="body"><i class="fas fa-align-center"></i></button>
                                <button class="align-btn" data-align="right" data-section="body"><i class="fas fa-align-right"></i></button>
                                <button class="align-btn" data-align="justify" data-section="body"><i class="fas fa-align-justify"></i></button>
                            </div>
                        </div>
                    </div>

                    <div class="custom-card">
                        <h4><i class="fas fa-shoe-prints"></i> Footer Styling</h4>
                        <div class="control-group">
                            <label>Background Color:</label>
                            <input id="footerBgColor" type="color" value="#ffffff"/>
                        </div>
                        <div class="control-group">
                            <label>Text Color:</label>
                            <input id="footerTextColor" type="color" value="#666666"/>
                        </div>
                        <div class="control-group">
                            <label>Font Family:</label>
                            <select id="footerFont">
                                <option value="Arial" selected>Arial</option>
                                <option value="Georgia">Georgia</option>
                                <option value="Times New Roman">Times New Roman</option>
                                <option value="Helvetica">Helvetica</option>
                                <option value="Verdana">Verdana</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>Font Size: <span id="footerFontSizeValue">14</span>px</label>
                            <input id="footerFontSize" type="range" min="10" max="20" value="14"/>
                        </div>
                        <div class="control-group">
                            <label>Padding: <span id="footerPaddingValue">20</span>px</label>
                            <input id="footerPadding" type="range" min="0" max="50" value="20"/>
                        </div>
                        <div class="control-group">
                            <label>Text Align:</label>
                            <div class="align-buttons">
                                <button class="align-btn" data-align="left" data-section="footer"><i class="fas fa-align-left"></i></button>
                                <button class="align-btn active" data-align="center" data-section="footer"><i class="fas fa-align-center"></i></button>
                                <button class="align-btn" data-align="right" data-section="footer"><i class="fas fa-align-right"></i></button>
                            </div>
                        </div>
                    </div>

                    <div class="custom-card">
                        <h4><i class="fas fa-image"></i> Logo Management</h4>
                        <div class="control-group">
                            <button class="btn btn-primary" id="uploadLogoBtn">
                                <i class="fas fa-upload"></i> Upload Logo
                            </button>
                            <input type="file" id="logoInput" accept="image/*" style="display: none;"/>
                        </div>
                        <div id="logoControls" style="display: none;">
                            <div class="control-group">
                                <label>Size: <span id="logoSizeValue">100</span>px</label>
                                <input id="logoSize" type="range" min="50" max="300" value="100"/>
                            </div>
                            <div class="control-group">
                                <label>Opacity: <span id="logoOpacityValue">100</span>%</label>
                                <input id="logoOpacity" type="range" min="0" max="100" value="100"/>
                            </div>
                            <div class="control-group">
                                <label>Rotation: <span id="logoRotationValue">0</span>Â°</label>
                                <input id="logoRotation" type="range" min="0" max="360" value="0"/>
                            </div>
                            <div class="control-group">
                                <button class="btn btn-danger" id="removeLogoBtn">
                                    <i class="fas fa-trash"></i> Remove Logo
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="tab-content" data-content="preview">
                <h2 class="no-print">Live Preview & Editor</h2>
                
                <div class="ai-analysis" id="aiAnalysis" style="display: none;">
                    <h3><i class="fas fa-brain"></i> AI Analysis</h3>
                    <div class="analysis-grid">
                        <div class="analysis-item">
                            <strong>Document Type:</strong>
                            <span id="detectedType">Unknown</span>
                        </div>
                        <div class="analysis-item">
                            <strong>Confidence:</strong>
                            <span id="confidence">0%</span>
                        </div>
                        <div class="analysis-item">
                            <strong>Sections Found:</strong>
                            <span id="sectionsCount">0</span>
                        </div>
                        <div class="analysis-item">
                            <strong>Word Count:</strong>
                            <span id="wordCount">0</span>
                        </div>
                    </div>
                </div>

                <div class="preview-editing-layout">
                    <!-- Editing Toolbar - Floating Right Panel -->
                    <div class="editing-toolbar-floating no-print" id="editingToolbar" style="display: none;">
                        <div class="toolbar-header">
                            <h3><i class="fas fa-magic"></i> Element Editor</h3>
                            <button class="close-toolbar-btn" id="closeToolbarBtn">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        
                        <div class="toolbar-content" id="toolbarContent">
                            <!-- Text Editing Section -->
                            <div class="toolbar-section" id="textEditSection">
                                <h4><i class="fas fa-font"></i> Text Styling</h4>
                                <div class="toolbar-controls">
                                    <div class="control-row">
                                        <label>Font Family:</label>
                                        <select id="textFontFamily" class="full-width">
                                            <option value="Arial">Arial</option>
                                            <option value="Georgia">Georgia</option>
                                            <option value="Times New Roman">Times New Roman</option>
                                            <option value="Helvetica">Helvetica</option>
                                            <option value="Verdana">Verdana</option>
                                            <option value="Courier New">Courier New</option>
                                            <option value="Tahoma">Tahoma</option>
                                        </select>
                                    </div>
                                    
                                    <div class="control-row">
                                        <label>Font Size:</label>
                                        <input type="number" id="textFontSize" min="8" max="72" value="16" class="full-width"/>
                                    </div>
                                    
                                    <div class="control-row">
                                        <label>Text Color:</label>
                                        <input type="color" id="textColor" value="#000000" class="full-width"/>
                                    </div>
                                    
                                    <div class="control-row">
                                        <label>Background:</label>
                                        <input type="color" id="textBgColor" value="#ffffff" class="full-width"/>
                                    </div>
                                    
                                    <div class="control-row">
                                        <label>Formatting:</label>
                                        <div class="btn-group">
                                            <button class="toolbar-btn" id="boldBtn" title="Bold"><i class="fas fa-bold"></i></button>
                                            <button class="toolbar-btn" id="italicBtn" title="Italic"><i class="fas fa-italic"></i></button>
                                            <button class="toolbar-btn" id="underlineBtn" title="Underline"><i class="fas fa-underline"></i></button>
                                        </div>
                                    </div>
                                    
                                    <div class="control-row">
                                        <label>Alignment:</label>
                                        <div class="btn-group">
                                            <button class="toolbar-btn" id="alignLeftBtn" title="Left"><i class="fas fa-align-left"></i></button>
                                            <button class="toolbar-btn" id="alignCenterBtn" title="Center"><i class="fas fa-align-center"></i></button>
                                            <button class="toolbar-btn" id="alignRightBtn" title="Right"><i class="fas fa-align-right"></i></button>
                                            <button class="toolbar-btn" id="alignJustifyBtn" title="Justify"><i class="fas fa-align-justify"></i></button>
                                        </div>
                                    </div>
                                    
                                    <div class="control-row">
                                        <label>Line Height:</label>
                                        <input type="number" id="textLineHeight" min="0.5" max="3" step="0.1" value="1.5" class="full-width"/>
                                    </div>
                                    
                                    <div class="control-row">
                                        <label>Letter Spacing:</label>
                                        <input type="number" id="textLetterSpacing" min="-2" max="10" step="0.5" value="0" class="full-width"/>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Image Editing Section -->
                            <div class="toolbar-section" id="imageEditSection">
                                <h4><i class="fas fa-image"></i> Image Editor</h4>
                                <div class="toolbar-controls">
                                    <div class="control-row">
                                        <label>Width (px):</label>
                                        <input type="number" id="imgWidth" min="50" max="1000" placeholder="Auto" class="full-width"/>
                                    </div>
                                    
                                    <div class="control-row">
                                        <label>Height (px):</label>
                                        <input type="number" id="imgHeight" min="50" max="1000" placeholder="Auto" class="full-width"/>
                                    </div>
                                    
                                    <div class="control-row">
                                        <button class="toolbar-btn full-width" id="lockAspectBtn" title="Lock Aspect Ratio">
                                            <i class="fas fa-lock-open"></i> Lock Aspect Ratio
                                        </button>
                                    </div>
                                    
                                    <div class="control-row">
                                        <label>Border Width:</label>
                                        <input type="number" id="imgBorderWidth" min="0" max="20" value="0" class="full-width"/>
                                    </div>
                                    
                                    <div class="control-row">
                                        <label>Border Color:</label>
                                        <input type="color" id="imgBorderColor" value="#000000" class="full-width"/>
                                    </div>
                                    
                                    <div class="control-row">
                                        <label>Border Radius:</label>
                                        <input type="number" id="imgBorderRadius" min="0" max="50" value="0" class="full-width"/>
                                    </div>
                                    
                                    <div class="control-row">
                                        <label>Opacity: <span id="imgOpacityValue">100%</span></label>
                                        <input type="range" id="imgOpacity" min="0" max="100" value="100" class="full-width"/>
                                    </div>
                                    
                                    <div class="control-row">
                                        <label>Rotation (deg):</label>
                                        <input type="number" id="imgRotate" min="0" max="360" value="0" class="full-width"/>
                                    </div>
                                    
                                    <div class="control-row">
                                        <button class="btn btn-primary full-width" id="cropImageBtn">
                                            <i class="fas fa-crop"></i> Crop Image
                                        </button>
                                    </div>
                                    
                                    <div class="control-row">
                                        <button class="btn btn-secondary full-width" id="resetImageBtn">
                                            <i class="fas fa-undo"></i> Reset Image
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="toolbar-actions">
                                <button class="btn btn-success full-width" id="applyChangesBtn">
                                    <i class="fas fa-check"></i> Apply Changes
                                </button>
                                <button class="btn btn-secondary full-width" id="cancelEditBtn">
                                    <i class="fas fa-times"></i> Cancel
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Crop Modal -->
                    <div class="crop-modal" id="cropModal" style="display: none;">
                        <div class="crop-modal-content">
                            <div class="crop-modal-header">
                                <h3><i class="fas fa-crop"></i> Crop Image</h3>
                                <button class="close-modal-btn" id="closeCropModal">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <div class="crop-modal-body">
                                <div class="crop-container">
                                    <canvas id="cropCanvas"></canvas>
                                    <div class="crop-overlay" id="cropOverlay">
                                        <div class="crop-box" id="cropBox">
                                            <div class="crop-handle nw"></div>
                                            <div class="crop-handle ne"></div>
                                            <div class="crop-handle sw"></div>
                                            <div class="crop-handle se"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="crop-controls">
                                    <button class="btn btn-success" id="applyCropBtn">
                                        <i class="fas fa-check"></i> Apply Crop
                                    </button>
                                    <button class="btn btn-secondary" id="cancelCropBtn">
                                        <i class="fas fa-times"></i> Cancel
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="preview-container">
                        <div class="document-preview" id="documentPreview">
                            <div class="logo-container" id="logoContainer" style="display: none;">
                                <img id="logoImage" src="" alt="Logo" draggable="true"/>
                            </div>
                            <div class="preview-section" id="previewHeader"></div>
                            <div class="preview-section" id="previewBody"></div>
                            <div class="preview-section" id="previewFooter"></div>
                        </div>
                    </div>
                </div>

                <div class="download-section no-print">
                    <h3>Export Your Document</h3>
                    <div class="download-buttons">
                        </div>
                </div>
            </div>
        </div>

    </div>

    <script src="file-handlers.js"></script>
    <script src="script.js"></script>

    <footer class="site-footer">
        <div class="footer-content">
            <p>Â© 2025 AI Document Formatter Pro | Created by <strong>Hamid Noorani</strong></p>
            <div class="social-links">
                <a href="https://www.linkedin.com/in/abdul-hamid-noorani-37258a351/" target="_blank">
                    <i class="fab fa-linkedin"></i>
                </a>
                <a href="https://www.instagram.com/hamidnoorani_04?igsh=amg0N2R1bzJ6aG1n" target="_blank">
                    <i class="fab fa-instagram"></i>
                </a>
            </div>
        </div>
    </footer>
</body>
</html>